// Generated by CoffeeScript 1.7.1
(function() {
  var Canvas, distance, drawGrid, resetCounts, runExperiment, setupDOM, showResults;

  Canvas = {
    width: 800,
    height: 800,
    totalRuns: 0,
    insideCircle: 0,
    textSize: 14,
    gridPadding: 40,
    pointRadius: 10,
    input: null,
    button: null,
    radius: 320,
    textArea: {
      x: 10,
      y: 20,
      w: 250,
      h: 90
    },
    getOrigin: function() {
      return {
        x: this.width / 2,
        y: this.height / 2
      };
    }
  };

  distance = function(x, y) {
    return Math.sqrt(x * x + y * y);
  };

  drawGrid = function() {
    var i, _i, _j, _ref, _ref1, _ref2, _ref3;
    textFont("monospace");
    fill(244);
    for (i = _i = 0, _ref = Canvas.height, _ref1 = Canvas.gridPadding; _ref1 > 0 ? _i <= _ref : _i >= _ref; i = _i += _ref1) {
      rect(0, i, Canvas.width, 1);
    }
    for (i = _j = 0, _ref2 = Canvas.width, _ref3 = Canvas.gridPadding; _ref3 > 0 ? _j <= _ref2 : _j >= _ref2; i = _j += _ref3) {
      rect(i, 0, 1, Canvas.height);
    }
    fill(200);
    rect(0, Canvas.getOrigin().y - 1, Canvas.width, 2);
    rect(Canvas.getOrigin().x - 1, 0, 2, Canvas.height);
    fill(204, 101, 192, 5);
    stroke(127, 63, 120);
    ellipse(Canvas.getOrigin().x, Canvas.getOrigin().y, 2 * Canvas.radius, 2 * Canvas.radius);
    return quad(Canvas.getOrigin().x - Canvas.radius, Canvas.getOrigin().y - Canvas.radius, Canvas.getOrigin().x + Canvas.radius, Canvas.getOrigin().y - Canvas.radius, Canvas.getOrigin().x + Canvas.radius, Canvas.getOrigin().y + Canvas.radius, Canvas.getOrigin().x - Canvas.radius, Canvas.getOrigin().y + Canvas.radius);
  };

  runExperiment = function() {
    var inside, pointX, pointY, x, y;
    x = Math.random() * Canvas.radius;
    y = Math.random() * Canvas.radius;
    noStroke();
    if ((distance(x, y)) - Canvas.radius > 0) {
      fill(226, 122, 63);
      inside = false;
    } else {
      fill(69, 178, 157);
      inside = true;
    }
    pointX = Canvas.getOrigin().x + x;
    pointY = Canvas.getOrigin().y - y;
    ellipse(pointX, pointY, Canvas.pointRadius, Canvas.pointRadius);
    return inside;
  };

  setupDOM = function() {
    Canvas.input = createInput();
    Canvas.input.position(20, 70);
    Canvas.button = createButton('Simulate!');
    Canvas.button.position(150, 70);
    return Canvas.button.mousePressed(function() {
      resetCounts();
      return loop();
    });
  };

  showResults = function() {
    var pi;
    fill(255);
    rect(Canvas.textArea.x - 10, Canvas.textArea.y - 10, Canvas.textArea.w, Canvas.textArea.h);
    stroke(0, 0, 0, 0);
    fill(196, 77, 88);
    pi = (4.0 * Canvas.insideCircle) / Canvas.totalRuns;
    textSize(12);
    text("Total Experiments (m): " + Canvas.totalRuns, Canvas.textArea.x, Canvas.textArea.y);
    text("Points inside circle (n): " + Canvas.insideCircle, Canvas.textArea.x, Canvas.textArea.y + 20);
    text("Estimated Pi = 4 x n / m", Canvas.textArea.x, Canvas.textArea.y + 40);
    textSize(18);
    return text("\u03a0 = " + pi, Canvas.textArea.x, Canvas.textArea.y + 70);
  };

  resetCounts = function() {
    Canvas.insideCircle = 0;
    return Canvas.totalRuns = 0;
  };

  window.setup = function() {
    noLoop();
    createCanvas(Canvas.width + 1, Canvas.height + 1);
    noStroke();
    drawGrid();
    return setupDOM();
  };

  window.draw = function() {
    Canvas.insideCircle += runExperiment() ? 1 : 0;
    Canvas.totalRuns += 1;
    showResults();
    if (Canvas.totalRuns + 1 > parseInt(Canvas.input.value() || 10)) {
      return noLoop();
    }
  };

}).call(this);
